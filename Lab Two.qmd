---
title: "Lab Two"
format: html
editor: visual
---

```{r}
#| echo: false
#| warning: false
#| message: false

if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)

# First plot
txhousing |> 
  filter(city=="Houston") |> 
  group_by(year) |> 
  summarize(sales=sum(sales, na.rm = TRUE)) |> 
  ggplot(aes(x=year, y=sales)) + 
    geom_line() + 
    ggtitle("Annual Houses Sold in Houston, TX")

# Second plot  
txhousing |> 
   filter(city=="Houston") |> 
    group_by(month) |> 
    summarize(avg_price=sum(volume, na.rm = TRUE) / sum(sales, na.rm = TRUE)) |> 
    mutate(month=factor(month.abb[month], 
                 levels=month.abb, ordered=TRUE)) |>
    ggplot(aes(x=month, y=avg_price)) + 
    geom_bar(stat="identity") + 
    ggtitle("Average Price of Houses Sold in Houston by Month") + 
    xlab("Month") + 
    ylab("Average Sale Price") + 
    scale_y_continuous(labels = scales::dollar)

# Third plot
txhousing |> filter(year==2015) |> 
    group_by(city) |> 
    summarize(avg_price=sum(volume, na.rm = TRUE) / sum(sales, na.rm = TRUE),
              num_sales=sum(sales, na.rm = TRUE)) |> 
    slice_max(num_sales, n=10) |>
    ggplot(aes(x=city, y=avg_price)) + 
    geom_bar(stat="identity") + 
    ggtitle("Average Price of Houses Sold in 2015 by City in Texas") + 
    xlab("City") + 
    ylab("Average Sale Price") + 
    scale_y_continuous(labels = scales::dollar)
```